# Mundo Cleaver 遊戲開發 - 前20個處理問題總結

本文檔記錄了在 Mundo Cleaver 遊戲開發過程中處理的 20 個問題，**按照提出順序排列**，包括具體狀況和最終解決方案。

---

## 問題排名（按提出順序）

### 1️⃣ 飛刀殘影問題
**提出次數：** 1次

**具體狀況：**
- 飛刀投擲時出現殘影效果
- 影響遊戲視覺體驗

**最終解決方案：**
- 修正飛刀渲染邏輯
- 確保舊飛刀正確從場景中移除
- 優化飛刀生命週期管理

**涉及版本：** 初始版本修正

---

### 2️⃣ 飛刀速度調整（第一次）
**提出次數：** 1次

**具體狀況：**
- 飛刀速度過慢
- 需要提升 20% 飛行速度

**最終解決方案：**
- 將飛刀速度從 2.94 提升到 3.528（+20%）

**涉及版本：** 初始版本後第一次更新

---

### 3️⃣ AI 強度提升（第一次）
**提出次數：** 1次

**具體狀況：**
- AI 強度不足
- 需要加強約 30%

**最終解決方案：**
- 提升 AI 準確度約 30%
- 改善 AI 瞄準精度

**涉及版本：** 初始版本強化

---

### 4️⃣ 飛刀速度調整（第二次）
**提出次數：** 1次

**具體狀況：**
- 飛刀速度仍需提升
- 要再提高 30% 飛行速度

**最終解決方案：**
- 再將速度從 3.528 提升到 4.5864（+30%）
- 最終飛刀速度比原始速度快 56%

**涉及版本：** 第二次速度更新

---

### 5️⃣ 角色陰影與 FPS 優化
**提出次數：** 1次

**具體狀況：**
- 角色陰影影響視覺效果
- FPS 需要提升

**最終解決方案：**
- 移除角色陰影（設置 `castShadow` 和 `receiveShadow` 為 false）
- 優化渲染設置
- FPS 性能顯著提升

**涉及版本：** 陰影移除版本

---

### 6️⃣ 影片背景實作
**提出次數：** 1次

**具體狀況：**
- 需要將影片設置為首頁背景
- 影片需要自動播放和循環

**最終解決方案：**
- 添加 HTML5 video 元素作為背景
- 設置 autoplay、loop、muted 屬性
- 使用 CSS 定位和縮放確保全屏覆蓋

**涉及版本：** 影片背景初始版本

---

### 7️⃣ 影片背景顯示灰色問題
**提出次數：** 1次

**具體狀況：**
- 影片背景在部署版本中顯示為灰色
- 原始影片編碼格式不被瀏覽器支援

**最終解決方案：**
- 使用 FFmpeg 重新編碼為相容格式（H.264 + AAC）
- 新增 WebM 版本和海報圖片
- 確保跨瀏覽器相容性

**涉及版本：** 影片背景修正版本

---

### 8️⃣ 字體風格變更
**提出次數：** 1次

**具體狀況：**
- 需要將字體改為類似 Diablo 的風格
- 提升遊戲整體視覺風格

**最終解決方案：**
- 引入 Google Fonts 'Cinzel' 字體
- 應用到所有遊戲界面文字
- 增加文字陰影效果

**涉及版本：** 字體更新版本

---

### 9️⃣ 影片背景縮放與白邊問題
**提出次數：** 2次

**具體狀況：**
- 第一次：影片背景需要縮小 20%
- 第二次：影片左右兩邊出現白邊

**最終解決方案：**
- 調整影片縮放比例（縮小 20%）
- 使用 `object-fit: cover` 和 `transform: scale(1.1)` 修正白邊
- 確保影片完整顯示且無白邊

**涉及版本：** 影片背景優化版本

---

### 🔟 按鈕外框顏色變更
**提出次數：** 1次

**具體狀況：**
- Create Room、Join Room、Practice with AI 按鈕外框需要變成暗紅色
- 提升視覺一致性

**最終解決方案：**
- 修改按鈕 CSS，設置 border 為暗紅色（#8b0000）
- 添加 hover 效果
- 統一按鈕視覺風格

**涉及版本：** 按鈕樣式更新版本

---

### 1️⃣1️⃣ 角色旋轉與相機定位問題
**提出次數：** 4次（v=97, v=100, v=103, v=105-110）

**具體狀況：**
- 角色面向錯誤方向
- 相機無法正確居中於角色
- 角色 Y 軸位置計算錯誤
- 需要多次調整

**最終解決方案：**
- v=97: 修正角色初始 `facing` 值
- v=100: 調整相機位置和 `lookAt` 目標
- v=103: 修正 `characterCenterY` 計算
- v=105-110: 優化相機位置和角色移動邏輯

**涉及版本：** v=97, v=100, v=103, v=105-110

---

### 1️⃣2️⃣ 血量顯示錯誤問題
**提出次數：** 2次（v=97, v=98）

**具體狀況：**
- 血量顯示值不正確
- 血量計算邏輯有誤

**最終解決方案：**
- v=97: 修正血量顯示邏輯
- v=98: 修正血量計算和顯示值
- 確保準確反映玩家和 AI 的當前血量

**涉及版本：** v=97, v=98

---

### 1️⃣3️⃣ Q 技能動畫問題
**提出次數：** 1次

**具體狀況：**
- Q 技能動畫播放有問題
- 動畫與技能釋放不同步

**最終解決方案：**
- 優化 Q 技能動畫觸發邏輯
- 確保動畫與技能釋放同步
- 改善視覺反饋

**涉及版本：** v=99

---

### 1️⃣4️⃣ 攻擊動畫鎖定玩家移動問題
**提出次數：** 1次（v=111）

**具體狀況：**
- Q 技能攻擊動畫持續時間過長
- 攻擊後玩家無法立即移動

**最終解決方案：**
- 移除 `updatePlayerMovement()` 中的 `player.isThrowingKnife` 檢查
- 允許玩家在技能動畫期間移動
- 攻擊動畫縮短

**涉及版本：** v=111

---

### 1️⃣5️⃣ 飛刀碰撞檢測範圍過大問題
**提出次數：** 1次（v=112）

**具體狀況：**
- Q 技能飛刀命中判定範圍過大
- 原始碰撞半徑為角色大小的 3 倍（31.5 單位）

**最終解決方案：**
- 將碰撞倍數從 3.0 降低到 0.7
- 新的碰撞半徑：7.35 單位（減少 76%）
- 飛刀需要明確擊中角色才會造成傷害

**涉及版本：** v=112

---

### 1️⃣6️⃣ 飛刀投擲方向不準確問題（第一次）
**提出次數：** 2次（v=114 之前多次反饋）

**具體狀況：**
- 飛刀有幾個特定方向
- 滑鼠靠近類似方向就向特定地方丟飛刀
- 不是精確跟隨滑鼠位置
- 用戶多次反饋此問題

**最終解決方案：**
- 在 `throwKnifeTowardsMouse()` 中添加即時 raycaster 計算
- 確保按 Q 時獲取最新滑鼠世界座標

**涉及版本：** v=114

---

### 1️⃣7️⃣ 飛刀投擲方向不準確問題（第二次 - macOS）
**提出次數：** 2次（v=114 修復後仍有問題，v=116 再次修復）

**具體狀況：**
- v=114 修復後 macOS 上仍然無法跟隨滑鼠位置
- 用戶再次反饋 macOS 特定問題
- 需要進一步修正

**最終解決方案：**
- 重構 `throwKnifeTowardsMouse()` 函數
- 使用 `lastMouseClientX` 和 `lastMouseClientY` 追蹤滑鼠座標
- 在函數內部進行 raycaster 計算

**涉及版本：** v=116

---

### 1️⃣8️⃣ 載入進度條視覺與百分比不同步問題
**提出次數：** 1次（v=116）

**具體狀況：**
- 載入畫面的紅色進度條沒有跟上百分比文字
- 例如文字顯示 60%，但進度條只在 40% 左右

**最終解決方案：**
- 在 `updateLoadingProgress()` 函數中添加 500ms 的 `setTimeout`
- 延遲隱藏載入覆蓋層，確保進度條動畫完成
- 視覺進度條與百分比文字完全同步

**涉及版本：** v=116

---

### 1️⃣9️⃣ 飛刀垂直偏移問題（Mac & Windows）
**提出次數：** 2次（Mac 和 Windows 分別反饋）

**具體狀況：**
- Mac 和 Windows 都有飛刀垂直偏移問題
- 用戶在不同平台上都反饋此問題
- 飛刀無法跟隨滑鼠的上下位置
- 方向向量硬編碼 Y 為 0，強制水平飛行

**最終解決方案：**
- 捕獲完整的 3D 射線方向（包括垂直分量）
- 在 `createKnife3DTowards()` 中使用真實 3D 方向
- 添加垂直速度分量 `vy`
- 在 `updateKnives()` 中處理垂直移動

**涉及版本：** v=117

---

### 2️⃣0️⃣ 倒數期間角色移動問題 + AI 不攻擊 + AI 智能提升
**提出次數：** 1次（v=117）

**具體狀況：**
- 倒數期間點擊右鍵會讓角色走動
- AI 完全不攻擊（cooldown 設置為 300000ms = 5 分鐘）
- AI 需要更智能的行為

**最終解決方案：**
- **倒數期間移動：** 在 `handlePlayerMovement()` 中添加 `gameState.countdownActive` 檢查
- **AI 攻擊：** 將 `knifeCooldown` 從 300000ms 改為 2200ms
- **AI 智能：** 添加預測瞄準（計算玩家 0.5 秒後位置）+ 90% 準確度 + 輕微隨機偏移

**涉及版本：** v=117

---

## 未來改進方向

1. **載入時間優化：** 進一步優化資源載入順序和方式
2. **跨平台相容性：** 確保所有平台（macOS、Windows、Android）體驗一致
3. **AI 行為多樣化：** 增加更多 AI 行為模式和策略
4. **效能持續優化：** 針對低階裝置進行更多優化
5. **多人遊戲優化：** 改善連線穩定性和延遲處理
6. **飛刀動畫：** 持續優化飛刀視覺效果

---

*本文檔最後更新：v=120*
*按照用戶提出問題的時間順序排列（1-20）*
*頻率計數已根據完整對話歷史重新統計*
